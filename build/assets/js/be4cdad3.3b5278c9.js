"use strict";(globalThis.webpackChunkhemihex_docs=globalThis.webpackChunkhemihex_docs||[]).push([[4213],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>l});var s=r(96540);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}},44364:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ROS2/ros2-service","title":"Service Communication","description":"1. Introduction","source":"@site/docs/10 - ROS2/08-ros2-service.md","sourceDirName":"10 - ROS2","slug":"/ROS2/ros2-service","permalink":"/docs/ROS2/ros2-service","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/10 - ROS2/08-ros2-service.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Service Communication"},"sidebar":"tutorialSidebar","previous":{"title":"TF Publishing and Monitoring","permalink":"/docs/ROS1/tf-publishing-and-monitoring"},"next":{"title":"Introduction to ROS 2","permalink":"/docs/ROS2/introduction-to-ros2"}}');var i=r(74848),t=r(28453);const c={sidebar_position:8,title:"Service Communication"},l="ROS 2 Service Communication",a={},d=[{value:"1. Introduction",id:"1-introduction",level:2},{value:"2. Create a New Package",id:"2-create-a-new-package",level:2},{value:"3. Server Implementation",id:"3-server-implementation",level:2},{value:"3.1 Create the Server Node",id:"31-create-the-server-node",level:3},{value:"3.2 Inspect the Service Interface",id:"32-inspect-the-service-interface",level:3},{value:"3.3 Register the Server in <code>setup.py</code>",id:"33-register-the-server-in-setuppy",level:3},{value:"3.4 Build the Package",id:"34-build-the-package",level:3},{value:"3.5 Run the Server",id:"35-run-the-server",level:3},{value:"3.6 Call the Service",id:"36-call-the-service",level:3},{value:"4. Client Implementation",id:"4-client-implementation",level:2},{value:"4.1 Create the Client File",id:"41-create-the-client-file",level:3},{value:"4.2 Client Implementation Code",id:"42-client-implementation-code",level:3},{value:"4.3 Register the Client in <code>setup.py</code>",id:"43-register-the-client-in-setuppy",level:3},{value:"4.4 Rebuild the Package",id:"44-rebuild-the-package",level:3},{value:"4.5 Run the Client",id:"45-run-the-client",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros-2-service-communication",children:"ROS 2 Service Communication"})}),"\n",(0,i.jsx)(n.h2,{id:"1-introduction",children:"1. Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["Service communication is a ",(0,i.jsx)(n.strong,{children:"request--response"})," communication model.\r\nThe client sends a request, and the server processes it and returns a\r\nresponse."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-create-a-new-package",children:"2. Create a New Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 pkg create pkg_service --build-type ament_python --dependencies rclpy --node-name server_demo\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-server-implementation",children:"3. Server Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"31-create-the-server-node",children:"3.1 Create the Server Node"}),"\n",(0,i.jsxs)(n.p,{children:["Edit ",(0,i.jsx)(n.code,{children:"server_demo.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\nclass Service_Server(Node):\r\n\r\n    def __init__(self, name):\r\n        super().__init__(name)\r\n\r\n        self.srv = self.create_service(\r\n            AddTwoInts,\r\n            \'/add_two_ints\',\r\n            self.Add2Ints_callback\r\n        )\r\n\r\n    def Add2Ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        print("response.sum =", response.sum)\r\n        return response\r\n\r\ndef main():\r\n    rclpy.init()\r\n    server_demo = Service_Server("publisher_node")\r\n    rclpy.spin(server_demo)\r\n    server_demo.destroy_node()\r\n    rclpy.shutdown()\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"32-inspect-the-service-interface",children:"3.2 Inspect the Service Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 interface show example_interfaces/srv/AddTwoInts\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"33-register-the-server-in-setuppy",children:["3.3 Register the Server in ",(0,i.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"'server_demo = pkg_service.server_demo:main',\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"34-build-the-package",children:"3.4 Build the Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"colcon build --packages-select pkg_service\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"35-run-the-server",children:"3.5 Run the Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run pkg_service server_demo\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"36-call-the-service",children:"3.6 Call the Service"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 1, b: 4}"\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-client-implementation",children:"4. Client Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"41-create-the-client-file",children:"4.1 Create the Client File"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"client_demo.py"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"42-client-implementation-code",children:"4.2 Client Implementation Code"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\nclass Service_Client(Node):\r\n\r\n    def __init__(self, name):\r\n        super().__init__(name)\r\n\r\n        self.client = self.create_client(AddTwoInts, \'/add_two_ints\')\r\n\r\n        while not self.client.wait_for_service(timeout_sec=1.0):\r\n            print("Service not available, waiting...")\r\n\r\n        self.request = AddTwoInts.Request()\r\n        self.request.a = 10\r\n        self.request.b = 20\r\n\r\n        self.future = self.client.call_async(self.request)\r\n        self.future.add_done_callback(self.response_callback)\r\n\r\n    def response_callback(self, future):\r\n        try:\r\n            response = future.result()\r\n            print("Service response:", response.sum)\r\n        except Exception as e:\r\n            print("Service call failed:", e)\r\n\r\ndef main():\r\n    rclpy.init()\r\n    client_demo = Service_Client("client_node")\r\n    rclpy.spin(client_demo)\r\n    client_demo.destroy_node()\r\n    rclpy.shutdown()\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"43-register-the-client-in-setuppy",children:["4.3 Register the Client in ",(0,i.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"'client_demo = pkg_service.client_demo:main',\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"44-rebuild-the-package",children:"4.4 Rebuild the Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"colcon build --packages-select pkg_service\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"45-run-the-client",children:"4.5 Run the Client"}),"\n",(0,i.jsx)(n.p,{children:"Ensure the server is running first:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run pkg_service server_demo\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then run the client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run pkg_service client_demo\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["Maintained by ",(0,i.jsx)(n.strong,{children:"HemiHex"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);