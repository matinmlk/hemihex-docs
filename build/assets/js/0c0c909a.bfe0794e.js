"use strict";(globalThis.webpackChunkhemihex_docs=globalThis.webpackChunkhemihex_docs||[]).push([[182],{6823:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"ROS1/publisher","title":"Publisher","description":"4.1 Publisher","source":"@site/docs/09 - ROS1/04-publisher.md","sourceDirName":"09 - ROS1","slug":"/ROS1/publisher","permalink":"/docs/ROS1/publisher","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/09 - ROS1/04-publisher.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Publisher","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Common Commands and Tools","permalink":"/docs/ROS1/common-commands-and-tools"},"next":{"title":"Subscribers","permalink":"/docs/ROS1/subscribers"}}');var i=a(4848),s=a(8453);const l={title:"Publisher",sidebar_position:4},t="4. Publisher",c={},o=[{value:"4.1 Publisher",id:"41-publisher",level:2},{value:"4.2 Create a Workspace and Topic Feature Package",id:"42-create-a-workspace-and-topic-feature-package",level:2},{value:"4.2.1 Creating a Workspace",id:"421-creating-a-workspace",level:3},{value:"4.2.2 Compilation Workspace",id:"422-compilation-workspace",level:3},{value:"4.2.3 Updating Environmental Variables",id:"423-updating-environmental-variables",level:3},{value:"4.2.4 Checking Environmental Variables",id:"424-checking-environmental-variables",level:3},{value:"4.2.5 Create Function Package",id:"425-create-function-package",level:3},{value:"4.2.6 Compilation Function Package",id:"426-compilation-function-package",level:3},{value:"4.3 Creating a Publisher",id:"43-creating-a-publisher",level:2},{value:"4.3.1 Creation Steps",id:"431-creation-steps",level:3},{value:"4.3.2 C++ Language Implementation",id:"432-c-language-implementation",level:3},{value:"Program Flow Diagram",id:"program-flow-diagram",level:3},{value:"CMakeLists.txt Configuration",id:"cmakeliststxt-configuration",level:3},{value:"Compile the Workspace",id:"compile-the-workspace",level:3},{value:"Run the Program",id:"run-the-program",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"4-publisher",children:"4. Publisher"})}),"\n",(0,i.jsx)(n.h2,{id:"41-publisher",children:"4.1 Publisher"}),"\n",(0,i.jsx)(n.p,{children:"Publishers are responsible for publishing messages. These messages can be sensor data transmitted from a lower-level controller to a higher-level system, or processed data sent from the upper computer to subscribers that have subscribed to the topic."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"42-create-a-workspace-and-topic-feature-package",children:"4.2 Create a Workspace and Topic Feature Package"}),"\n",(0,i.jsx)(n.h3,{id:"421-creating-a-workspace",children:"4.2.1 Creating a Workspace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/catkin_ws/src\ncd ~/catkin_ws/src\ncatkin_init_workspace\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"422-compilation-workspace",children:"4.2.2 Compilation Workspace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/catkin_ws/\ncatkin_make\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"423-updating-environmental-variables",children:"4.2.3 Updating Environmental Variables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source devel/setup.bash\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"424-checking-environmental-variables",children:"4.2.4 Checking Environmental Variables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo $ROS_PACKAGE_PATH\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"425-create-function-package",children:"4.2.5 Create Function Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/catkin_ws/src\ncatkin_create_pkg learning_topic std_msgs rospy roscpp geometry_msgs turtlesim\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"426-compilation-function-package",children:"4.2.6 Compilation Function Package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/catkin_ws\ncatkin_make\nsource ~/catkin_ws/devel/setup.bash\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"43-creating-a-publisher",children:"4.3 Creating a Publisher"}),"\n",(0,i.jsx)(n.h3,{id:"431-creation-steps",children:"4.3.1 Creation Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Initialize the ROS node"}),"\n",(0,i.jsx)(n.li,{children:"Create a node handle"}),"\n",(0,i.jsx)(n.li,{children:"Register node information with ROS Master"}),"\n",(0,i.jsx)(n.li,{children:"Create and initialize message data"}),"\n",(0,i.jsx)(n.li,{children:"Send messages in a loop at a fixed frequency"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"432-c-language-implementation",children:"4.3.2 C++ Language Implementation"}),"\n",(0,i.jsxs)(n.p,{children:["Create the file below inside the ",(0,i.jsx)(n.code,{children:"src"})," directory of your package:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"turtle_velocity_publisher.cpp\n"})}),"\n",(0,i.jsx)(n.p,{children:"Paste the following code into the file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <ros/ros.h>\n#include <geometry_msgs/Twist.h>\n\nint main(int argc, char **argv)\n{\n    ros::init(argc, argv, "turtle_velocity_publisher");\n    ros::NodeHandle n;\n\n    ros::Publisher turtle_vel_pub = n.advertise<geometry_msgs::Twist>("/turtle1/cmd_vel", 10);\n    ros::Rate loop_rate(10);\n\n    while (ros::ok())\n    {\n        geometry_msgs::Twist turtle_vel_msg;\n        turtle_vel_msg.linear.x = 0.8;\n        turtle_vel_msg.angular.z = 0.6;\n\n        turtle_vel_pub.publish(turtle_vel_msg);\n\n        ROS_INFO("Publish turtle velocity command [%0.2f m/s, %0.2f rad/s]",\n                 turtle_vel_msg.linear.x, turtle_vel_msg.angular.z);\n\n        loop_rate.sleep();\n    }\n\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"program-flow-diagram",children:"Program Flow Diagram"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"C++ Publisher Flow",src:a(9718).A+"",width:"482",height:"658"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"cmakeliststxt-configuration",children:"CMakeLists.txt Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Add the following to your ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmake",children:"add_executable(turtle_velocity_publisher src/turtle_velocity_publisher.cpp)\ntarget_link_libraries(turtle_velocity_publisher ${catkin_LIBRARIES})\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"compile-the-workspace",children:"Compile the Workspace"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/catkin_ws\ncatkin_make\nsource devel/setup.bash\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"run-the-program",children:"Run the Program"}),"\n",(0,i.jsx)(n.p,{children:"Start ROS master:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"roscore\n"})}),"\n",(0,i.jsx)(n.p,{children:"Run the turtle simulator:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rosrun turtlesim turtlesim_node\n"})}),"\n",(0,i.jsx)(n.p,{children:"Run the publisher node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rosrun learning_topic turtle_velocity_publisher\n"})}),"\n",(0,i.jsx)(n.p,{children:"\ue200filecite\ue202turn3file0\ue201"})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>t});var r=a(6540);const i={},s=r.createContext(i);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},9718:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/pub_c++-04aa6a03256ebea9b76fb386fccb8e4d.png"}}]);