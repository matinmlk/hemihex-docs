"use strict";(globalThis.webpackChunkhemihex_docs=globalThis.webpackChunkhemihex_docs||[]).push([[7961],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(96540);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}},36681:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Jetson/ROS1/custom-service-messages-and-usage","title":"Custom Service Messages and Usage","description":"This section explains how to define and use custom ROS service","source":"@site/docs/Jetson/09 - ROS1/09-custom-service-messages-and-usage.md","sourceDirName":"Jetson/09 - ROS1","slug":"/Jetson/ROS1/custom-service-messages-and-usage","permalink":"/docs/Jetson/ROS1/custom-service-messages-and-usage","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Jetson/09 - ROS1/09-custom-service-messages-and-usage.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"Custom Service Messages and Usage"},"sidebar":"tutorialSidebar","previous":{"title":"Server Side","permalink":"/docs/Jetson/ROS1/server-side"},"next":{"title":"TF Publishing and Monitoring","permalink":"/docs/Jetson/ROS1/tf-publishing-and-monitoring"}}');var i=s(74848),t=s(28453);const a={sidebar_position:9,title:"Custom Service Messages and Usage"},l="9. Custom Service Messages and Usage",c={},d=[{value:"9.1 Customized Service Messages",id:"91-customized-service-messages",level:2},{value:"9.1.1 Define SRV Files",id:"911-define-srv-files",level:3},{value:"9.1.2 Add Feature Pack Dependencies in <code>package.xml</code>",id:"912-add-feature-pack-dependencies-in-packagexml",level:3},{value:"9.1.3 Add Compilation Options in <code>CMakeLists.txt</code>",id:"913-add-compilation-options-in-cmakeliststxt",level:3},{value:"9.1.4 Compile and Generate Language-Related Files",id:"914-compile-and-generate-language-related-files",level:3},{value:"9.1.5 C++ Language Implementation",id:"915-c-language-implementation",level:2},{value:"Step 1: Create Server and Client Source Files",id:"step-1-create-server-and-client-source-files",level:3},{value:"IntPlus_server.cpp",id:"intplus_servercpp",level:3},{value:"IntPlus_client.cpp",id:"intplus_clientcpp",level:3},{value:"Step 2: Modify <code>CMakeLists.txt</code>",id:"step-2-modify-cmakeliststxt",level:3},{value:"Step 3: Core Header Import",id:"step-3-core-header-import",level:3}];function o(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"9-custom-service-messages-and-usage",children:"9. Custom Service Messages and Usage"})}),"\n",(0,i.jsxs)(n.p,{children:["This section explains how to define and use ",(0,i.jsx)(n.strong,{children:"custom ROS service\r\nmessages"}),", including configuration, compilation, and both C++\r\nserver/client implementations."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"91-customized-service-messages",children:"9.1 Customized Service Messages"}),"\n",(0,i.jsxs)(n.p,{children:["Switch to the following directory and create a new folder named ",(0,i.jsx)(n.code,{children:"srv"})," to\r\nstore custom service message files:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"~/catkin_ws/src/learning_server/srv\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"911-define-srv-files",children:"9.1.1 Define SRV Files"}),"\n",(0,i.jsxs)(n.p,{children:["Create a new ",(0,i.jsx)(n.code,{children:".srv"})," file. Here we use ",(0,i.jsx)(n.strong,{children:"IntPlus.srv"})," as an example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"uint8  a\r\nuint8  b\r\n\r\n---\r\n\r\nuint8 result\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation:"}),(0,i.jsx)(n.br,{}),"\n","The SRV file is divided into two parts by the ",(0,i.jsx)(n.code,{children:"---"})," separator:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Top section"})," \u2192 Request data\\"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bottom section"})," \u2192 Response data"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"912-add-feature-pack-dependencies-in-packagexml",children:["9.1.2 Add Feature Pack Dependencies in ",(0,i.jsx)(n.code,{children:"package.xml"})]}),"\n",(0,i.jsx)(n.p,{children:"Add the following dependencies:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<build_depend>message_generation</build_depend>\r\n<exec_depend>message_runtime</exec_depend>\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"913-add-compilation-options-in-cmakeliststxt",children:["9.1.3 Add Compilation Options in ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,i.jsx)(n.p,{children:"Add the following configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmake",children:"add_service_files(FILES IntPlus.srv)\r\ngenerate_messages(DEPENDENCIES std_msgs)\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"914-compile-and-generate-language-related-files",children:"9.1.4 Compile and Generate Language-Related Files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/catkin_ws\r\ncatkin_make\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"915-c-language-implementation",children:"9.1.5 C++ Language Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-server-and-client-source-files",children:"Step 1: Create Server and Client Source Files"}),"\n",(0,i.jsx)(n.p,{children:"Navigate to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"~/catkin_ws/src/learning_server/src\n"})}),"\n",(0,i.jsx)(n.p,{children:"Create the following files:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"IntPlus_server.cpp\r\nIntPlus_client.cpp\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"intplus_servercpp",children:"IntPlus_server.cpp"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <ros/ros.h>\r\n#include "learning_server/IntPlus.h"\r\n\r\nbool IntPlusCallback(learning_server::IntPlus::Request  &req,\r\n                     learning_server::IntPlus::Response &res)\r\n{\r\n    ROS_INFO("number 1 is:%d , number 2 is:%d", req.a, req.b);\r\n\r\n    res.result = req.a + req.b;\r\n    return true;\r\n}\r\n\r\nint main(int argc, char **argv)\r\n{\r\n    ros::init(argc, argv, "IntPlus_server");\r\n    ros::NodeHandle n;\r\n\r\n    ros::ServiceServer Int_Plus_service =\r\n        n.advertiseService("/Two_Int_Plus", IntPlusCallback);\r\n\r\n    ROS_INFO("Ready to calculate.");\r\n    ros::spin();\r\n\r\n    return 0;\r\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"intplus_clientcpp",children:"IntPlus_client.cpp"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <ros/ros.h>\r\n#include "learning_server/IntPlus.h"\r\n#include <iostream>\r\n\r\nusing namespace std;\r\n\r\nint main(int argc, char** argv)\r\n{\r\n    int i, k;\r\n    cin >> i;\r\n    cin >> k;\r\n\r\n    ros::init(argc, argv, "IntPlus_client");\r\n    ros::NodeHandle node;\r\n\r\n    ros::service::waitForService("/Two_Int_Plus");\r\n\r\n    ros::ServiceClient IntPlus_client =\r\n        node.serviceClient<learning_server::IntPlus>("/Two_Int_Plus");\r\n\r\n    learning_server::IntPlus srv;\r\n    srv.request.a = i;\r\n    srv.request.b = k;\r\n\r\n    ROS_INFO("Call service to plus %d and %d",\r\n             srv.request.a, srv.request.b);\r\n\r\n    IntPlus_client.call(srv);\r\n\r\n    ROS_INFO("Show the result : %d", srv.response.result);\r\n\r\n    return 0;\r\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"step-2-modify-cmakeliststxt",children:["Step 2: Modify ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmake",children:"add_executable(IntPlus_server src/IntPlus_server.cpp)\r\ntarget_link_libraries(IntPlus_server ${catkin_LIBRARIES})\r\nadd_dependencies(IntPlus_server ${PROJECT_NAME}_generate_messages_cpp)\r\n\r\nadd_executable(IntPlus_client src/IntPlus_client.cpp)\r\ntarget_link_libraries(IntPlus_client ${catkin_LIBRARIES})\r\nadd_dependencies(IntPlus_client ${PROJECT_NAME}_generate_messages_cpp)\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-3-core-header-import",children:"Step 3: Core Header Import"}),"\n",(0,i.jsx)(n.p,{children:"To use the custom service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include "learning_server/IntPlus.h"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"learning_server"})," is the name of the package, and ",(0,i.jsx)(n.code,{children:"IntPlus.h"})," is\r\nauto-generated from the ",(0,i.jsx)(n.code,{children:".srv"})," file."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["\u2705 You now have a fully working ",(0,i.jsx)(n.strong,{children:"custom ROS service"})," with both server\r\nand client implementations."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);