"use strict";(globalThis.webpackChunkhemihex_docs=globalThis.webpackChunkhemihex_docs||[]).push([[6150],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var s=t(96540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},57753:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HH-101/Online AI Model/AI-Large-Model-Online-Voice-Assistant","title":"AI large model online voice assistant","description":"1. Online Voice Configuration","source":"@site/docs/hh101/HH-101/12 - Online AI Model/13-AI-Large-Model-Online-Voice-Assistant.md","sourceDirName":"HH-101/12 - Online AI Model","slug":"/HH-101/Online AI Model/AI-Large-Model-Online-Voice-Assistant","permalink":"/hh-101/HH-101/Online AI Model/AI-Large-Model-Online-Voice-Assistant","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"title":"AI large model online voice assistant","sidebar_position":13},"sidebar":"hh101Sidebar","previous":{"title":"Online speech to text (ASR)","permalink":"/hh-101/HH-101/Online AI Model/Online-Speech-to-Text-ASR"},"next":{"title":"Build Isaac ROS environment","permalink":"/hh-101/HH-101/NVIDIA Isaac ROS Course/Build-Isaac-ROS-Environment"}}');var i=t(74848),r=t(28453);const a={title:"AI large model online voice assistant",sidebar_position:13},l="8.AI large model online voice assistant",o={},c=[{value:"1. Online Voice Configuration",id:"1-online-voice-configuration",level:2},{value:"2. Create a Startup Service (Systemd)",id:"2-create-a-startup-service-systemd",level:2},{value:"2.1 Create a Startup Script",id:"21-create-a-startup-script",level:3},{value:"2.2 Creating the Systemd Service File",id:"22-creating-the-systemd-service-file",level:3},{value:"2.3 Managing and Debugging Services",id:"23-managing-and-debugging-services",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"8ai-large-model-online-voice-assistant",children:"8.AI large model online voice assistant"})}),"\n",(0,i.jsx)(n.h2,{id:"1-online-voice-configuration",children:"1. Online Voice Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Before setting up automatic startup, we must ensure that the program itself can operate independently in an online state. This can be accomplished by modifying the configuration file."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Locate the Configuration File : In your project code, find and open the configuration file:"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"config/HemiHex.yaml"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Modify Configuration Parameters : Please check the following parameters in the file and ensure that their values match those shown below. If the parameters do not exist, add them.  x asr : #Voice node parameters ros__parameters : VAD_MODE : 2 #vad sensitivity sample_rate : 16000 #asr recording audio sampling rate frame_duration_ms : 30 #vad frame size in ms use_oline_asr : True #Whether to use online ASR recognition (True uses online, False uses offline) mic_serial_port : \"/dev/ttyUSB0\" #Microphone serial port alias mic_index : 0 #Microphone Index language : 'zh' #asr language  model_service : #Model server node parameters ros__parameters : language : 'zh' #Large Model Interface Language useolinetts : True #Whether to use online speech synthesis (True uses online, False uses offline)  # Large model configuration # llm_platform: 'ollama'              # Optional platforms:'ollama', 'tongyi', 'spark', 'qianfan', 'openrouter' llm_platform : 'tongyi' # Here we take Tongyi as an example  use_oline_asr and useolinetts must be set to tongyi . llm_platform must be set to tongyi ."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"With this setup, everything is online."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Save the file and recompile the project to apply the changes: xxxxxxxxxx cd ~/hemihex_ws colcon build source install/setup.bash"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"After completing this step, the program is now a fully online voice service."}),"\n",(0,i.jsx)(n.h2,{id:"2-create-a-startup-service-systemd",children:"2. Create a Startup Service (Systemd)"}),"\n",(0,i.jsxs)(n.p,{children:["Now, we will create a systemd service to automatically run",(0,i.jsx)(n.code,{children:"largemodel_control.launch.py"}),"at system startup."]}),"\n",(0,i.jsx)(n.h3,{id:"21-create-a-startup-script",children:"2.1 Create a Startup Script"}),"\n",(0,i.jsxs)(n.p,{children:["To ensure",(0,i.jsx)(n.code,{children:"systemd"}),"can correctly load the ROS2 environment, it's best to create a simple",(0,i.jsx)(n.code,{children:"bash"}),"script to encapsulate our startup commands."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a Script File : In the directory ( ~/hemihex_ws/src/largemodel/ ), create a file named start_largemodel.sh . xxxxxxxxxx vim ~/hemihex_ws/src/largemodel/start_largemodel.sh"}),"\n",(0,i.jsx)(n.li,{children:"Write the script : Copy and paste the following content into the script file. xxxxxxxxxx #!/bin/bash  # Source ROS2 Humble Environment source /opt/ros/humble/setup.bash  # Source HemiHex Workspace environment source /home/jetson/hemihex_ws/install/setup.bash  # \u542f\u52a8 largemodel Control Script ros2 launch largemodel largemodel_control.launch.py Important : Please make sure to replace /home/sunrise/ in the script with your own home directory path."}),"\n",(0,i.jsx)(n.li,{children:"Save and exit"}),"\n",(0,i.jsx)(n.li,{children:"Give the script execute permissions : xxxxxxxxxx chmod + x ~/hemihex_ws/src/largemodel/start_largemodel.sh"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"22-creating-the-systemd-service-file",children:"2.2 Creating the Systemd Service File"}),"\n",(0,i.jsx)(n.p,{children:"This is the most crucial step. We'll tell the system that we have a new service to manage."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Creating the Service File : You will need sudo privileges to create this file."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo vim /etc/systemd/system/largemodel.service\n"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Write the Service Configuration : Copy and paste the following content exactly into the service file. xxxxxxxxxx [Unit] Description = Robot Service After = network.target sound.target graphical.target multi-user.target Wants = network.target sound.target graphical.target multi-user.target  [Service] Type = simple User = sunrise Group = sunrise Environment = DISPLAY =: 0 Environment = XDG_RUNTIME_DIR = /run/user/1000 Environment = PULSE_SERVER = unix : /run/user/1000/pulse/native SupplementaryGroups = audio video ExecStartPre = /bin/sleep 10 ExecStart = /home/sunrise/hemihex_ws/src/largemodel/start_largemodel.sh Restart = on-failure StandardOutput = journal StandardError = journal  [Install] WantedBy = multi-user.target !!! EXTREMELY IMPORTANT! Make sure the paths in WorkingDirectory and ExecStart match your actual paths exactly."}),"\n",(0,i.jsx)(n.li,{children:"Save and exit ."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"23-managing-and-debugging-services",children:"2.3 Managing and Debugging Services"}),"\n",(0,i.jsxs)(n.p,{children:["Now that your service is created, we need to have",(0,i.jsx)(n.code,{children:"systemd"}),"load it and set it to start automatically at boot."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Reload the systemd daemon so it reads our newly created service file:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl daemon-reload\n"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Set the service to start automatically at boot :"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable largemodel.service\n"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Start the service immediately :"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl start largemodel.service\n"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check the service status : This is the most important command to verify that the service is running successfully."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status largemodel.service\n``` * If you see `Active: active (running)`, congratulations! The service has started successfully!\n* If the status is `failed` or something else, proceed to the next step for debugging.\n"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"View the service log (essential for debugging) : If the service fails to start, you can view all real-time logs generated by the ros2 launch command using the following command. This is crucial for troubleshooting."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"journalctl -u largemodel.service -f\n"})}),"\n",(0,i.jsxs)(n.p,{children:["After completing all the above steps, the fully online",(0,i.jsx)(n.code,{children:"largemodel"}),"voice service will automatically start every time you boot your computer."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);