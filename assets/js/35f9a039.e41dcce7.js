"use strict";(globalThis.webpackChunkhemihex_docs=globalThis.webpackChunkhemihex_docs||[]).push([[6367],{28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>r});var o=n(96540);const l={},t=o.createContext(l);function a(e){const i=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),o.createElement(t.Provider,{value:i},e.children)}},51990:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"HH-101/Offline AI Model/multi-module-visual-position-application-11-offlineaimodel-11-14","title":"Multi-module Visual Position Application","description":"1. Introduction","source":"@site/docs/hh101/HH-101/11 - Offline AI Model/14-multi-module-visual-position-application-11-offlineaimodel-11-14.md","sourceDirName":"HH-101/11 - Offline AI Model","slug":"/HH-101/Offline AI Model/multi-module-visual-position-application-11-offlineaimodel-11-14","permalink":"/hh-101/HH-101/Offline AI Model/multi-module-visual-position-application-11-offlineaimodel-11-14","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":0,"frontMatter":{"title":"Multi-module Visual Position Application","sidebar_position":0},"sidebar":"hh101Sidebar","previous":{"title":"Multimodal Video Analysis Application","permalink":"/hh-101/HH-101/Offline AI Model/multimodal-video-analysis-application-11-offlineaimodel-11-13"},"next":{"title":"Multimodal Table Scanning Application","permalink":"/hh-101/HH-101/Offline AI Model/multimodal-table-scanning-application-11-offlineaimodel-11-15"}}');var l=n(74848),t=n(28453);const a={title:"Multi-module Visual Position Application",sidebar_position:0},r="Multi module visual position application",s={},d=[{value:"1. Introduction",id:"1-introduction",level:2},{value:"1.1 What is &quot;Multimodal Visual Localization&quot;?",id:"11-what-is-multimodal-visual-localization",level:3},{value:"1.2 Overview of Implementation Principles",id:"12-overview-of-implementation-principles",level:3},{value:"2. Code Analysis",id:"2-code-analysis",level:2},{value:"Key Code",id:"key-code",level:3},{value:"1. Tools Layer Entry ( largemodel/utils/tools_manager.py )",id:"1-tools-layer-entry--largemodelutilstools_managerpy-",level:4},{value:"2. Model Interface Layer ( largemodel/utils/large_model_interface.py )",id:"2-model-interface-layer--largemodelutilslarge_model_interfacepy-",level:4},{value:"Code Analysis",id:"code-analysis",level:3},{value:"3. Practical Operations",id:"3-practical-operations",level:2},{value:"3.1 Configuring the Offline Large Model",id:"31-configuring-the-offline-large-model",level:3},{value:"3.1.1 Configuring the LLM Platform (HemiHex.yaml)",id:"311-configuring-the-llm-platform-hemihexyaml",level:4},{value:"3.1.2 Configuring the Model Interface ( large_model_interface.yaml )",id:"312-configuring-the-model-interface--large_model_interfaceyaml-",level:4},{value:"3.2 Starting and Testing the Feature (Text Mode)",id:"32-starting-and-testing-the-feature-text-mode",level:3},{value:"4. Common Problems and Solutions",id:"4-common-problems-and-solutions",level:2},{value:"Problem 1: &quot;Image file not found&quot; error message",id:"problem-1-image-file-not-found-error-message",level:4}];function c(e){const i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.header,{children:(0,l.jsx)(i.h1,{id:"multi-module-visual-position-application",children:"Multi module visual position application"})}),"\n",(0,l.jsx)(i.h2,{id:"1-introduction",children:"1. Introduction"}),"\n",(0,l.jsx)(i.h3,{id:"11-what-is-multimodal-visual-localization",children:'1.1 What is "Multimodal Visual Localization"?'}),"\n",(0,l.jsx)(i.p,{children:"Multimodal visual localization is a technology that combines multiple sensor inputs (such as cameras, depth sensors, and IMUs) with algorithmic processing techniques to accurately identify and track the position and posture of a device or user in an environment. This technology does not rely solely on a single type of sensor data, but instead integrates information from different perception modalities, thereby improving localization accuracy and robustness."}),"\n",(0,l.jsx)(i.h3,{id:"12-overview-of-implementation-principles",children:"1.2 Overview of Implementation Principles"}),"\n",(0,l.jsx)(i.h2,{id:"2-code-analysis",children:"2. Code Analysis"}),"\n",(0,l.jsx)(i.h3,{id:"key-code",children:"Key Code"}),"\n",(0,l.jsx)(i.h4,{id:"1-tools-layer-entry--largemodelutilstools_managerpy-",children:"1. Tools Layer Entry ( largemodel/utils/tools_manager.py )"}),"\n",(0,l.jsx)(i.p,{children:"The visual_positioning function in this file defines the execution flow of the tool, specifically how it constructs a prompt containing the target object name and formatting requirements.\r\n[TODO7]"}),"\n",(0,l.jsx)(i.h4,{id:"2-model-interface-layer--largemodelutilslarge_model_interfacepy-",children:"2. Model Interface Layer ( largemodel/utils/large_model_interface.py )"}),"\n",(0,l.jsx)(i.p,{children:"The infer_with_image function in this file serves as the unified entry point for all image-related tasks.\r\n[TODO8]"}),"\n",(0,l.jsx)(i.h3,{id:"code-analysis",children:"Code Analysis"}),"\n",(0,l.jsx)(i.p,{children:"The core of the visual positioning function lies in guiding large models to output structured data through precise instructions . It also follows a layered design with a tool layer and a model interface layer."}),"\n",(0,l.jsx)(i.p,{children:"Tools layer ( tools_manager.py ) :"}),"\n",(0,l.jsx)(i.p,{children:"Model interface layer ( large_model_interface.py ) :"}),"\n",(0,l.jsx)(i.p,{children:"In summary, the general workflow for visual localization is: ToolsManager receives the target object name and constructs a precise prompt requesting coordinates. ToolsManager calls the model interface. ModelInterface packages the image and prompt together and sends them to the corresponding model platform according to the configuration. The model returns text containing the coordinates. ModelInterface returns this text to ToolsManager. ToolsManager parses the text, extracts the structured coordinate data, and returns it. This process demonstrates how Prompt Engineering can enable a general-purpose large visual model to accomplish more specific and structured tasks."}),"\n",(0,l.jsx)(i.h2,{id:"3-practical-operations",children:"3. Practical Operations"}),"\n",(0,l.jsx)(i.h3,{id:"31-configuring-the-offline-large-model",children:"3.1 Configuring the Offline Large Model"}),"\n",(0,l.jsx)(i.h4,{id:"311-configuring-the-llm-platform-hemihexyaml",children:"3.1.1 Configuring the LLM Platform (HemiHex.yaml)"}),"\n",(0,l.jsx)(i.p,{children:"This file determines which large model platform the model_service node loads as its primary language model."}),"\n",(0,l.jsx)(i.p,{children:"Open the file in terminal :"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"vim ~/yahboom_ws/src/largemodel/config/HemiHex.yaml\n"})}),"\n",(0,l.jsx)(i.p,{children:"[TODO9]"}),"\n",(0,l.jsx)(i.h4,{id:"312-configuring-the-model-interface--large_model_interfaceyaml-",children:"3.1.2 Configuring the Model Interface ( large_model_interface.yaml )"}),"\n",(0,l.jsx)(i.p,{children:"This file defines which vision model to use when the ollama platform is selected."}),"\n",(0,l.jsx)(i.p,{children:"1.Open the file in Terminal"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"vim ~/yahboom_ws/src/largemodel/config/large_model_interface.yaml\n"})}),"\n",(0,l.jsx)(i.p,{children:"2.Find the ollama related configuration\r\n[TODO10]"}),"\n",(0,l.jsx)(i.p,{children:"Note : Please make sure that the model specified in the configuration parameters (such as llava ) can handle multimodal input."}),"\n",(0,l.jsx)(i.h3,{id:"32-starting-and-testing-the-feature-text-mode",children:"3.2 Starting and Testing the Feature (Text Mode)"}),"\n",(0,l.jsx)(i.admonition,{type:"warning",children:(0,l.jsx)(i.p,{children:"Due to performance limitations, the Jetson Orin Nano 4GB may not perform well. To experience this feature, please refer to the corresponding section in [Online Large Model (Text Interaction)]"})}),"\n",(0,l.jsx)(i.p,{children:"Prepare image files :"}),"\n",(0,l.jsx)(i.p,{children:"Place an image file to test in the following path: /home/jetson/yahboom_ws/src/largemodel/resources_file/visual_positioning"}),"\n",(0,l.jsx)(i.p,{children:"Then name the image test_image.jpg"}),"\n",(0,l.jsx)(i.p,{children:"Start the largemodel main program (in text mode):"}),"\n",(0,l.jsx)(i.p,{children:"Open a terminal and run the following command\uff1a"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"ros2 launch largemodel largemodel_control.launch.py text_chat_mode:=true\n"})}),"\n",(0,l.jsx)(i.p,{children:"Send text command : Open another terminal again and run the following command,"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"ros2 run text_chat text_chat\n"})}),"\n",(0,l.jsx)(i.p,{children:'Then start typing text: "Analyze the position of the dinosaur in the picture."'}),"\n",(0,l.jsxs)(i.p,{children:["Observations ",":In"," the first terminal where you run the main program, you'll see log output indicating that the system received the command, called the visual_positioning tool, completed the execution, and saved the coordinates to a file."]}),"\n",(0,l.jsx)(i.p,{children:"This file can be found in the ~/yahboom_ws/src/largemodel/resources_file/visual_positioning directory."}),"\n",(0,l.jsx)(i.h2,{id:"4-common-problems-and-solutions",children:"4. Common Problems and Solutions"}),"\n",(0,l.jsx)(i.h4,{id:"problem-1-image-file-not-found-error-message",children:'Problem 1: "Image file not found" error message'}),"\n",(0,l.jsx)(i.p,{children:"Solution :"})]})}function m(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}}}]);